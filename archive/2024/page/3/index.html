
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="lnw143">
      
      
        <link rel="canonical" href="https://lnw143.github.io/blog/archive/2024/page/3/">
      
      
        <link rel="prev" href="../../../2025/">
      
      
        <link rel="next" href="../../../../geometry/">
      
      
      <link rel="icon" href="../../../../favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>2024 - Liam's Blog</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <script src="../../../../assets/javascripts/toggle-sidebar.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2024" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../.." title="Liam&#39;s Blog" class="md-header__button md-logo" aria-label="Liam's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.15 19h-5.76v-2.13c2.11-1.62 3.2-3.63 3.2-6.03 0-1.5-.43-2.68-1.27-3.55C14.47 6.42 13.37 6 12.03 6c-1.35 0-2.46.42-3.32 1.3-.87.87-1.3 2.07-1.3 3.58 0 2.38 1.09 4.38 3.2 5.99V19H4.85v-2.13h3.56c-2.37-1.55-3.56-3.64-3.56-6.27 0-2.1.65-3.74 1.96-4.94 1.31-1.21 3.03-1.81 5.16-1.81 2.18 0 3.92.6 5.22 1.79 1.31 1.19 1.96 2.86 1.96 4.94 0 2.63-1.2 4.73-3.6 6.29h3.6z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Liam's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2024
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="white"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/lnw143/blog" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    blog
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../.." class="md-tabs__link">
          
  
  
    
  
  主页

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../geometry/" class="md-tabs__link">
          
  
  
    
  
  Geometry

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../poly/" class="md-tabs__link">
          
  
  
    
  
  Poly

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../number-theory/" class="md-tabs__link">
          
  
  
    
  
  Number Theory

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../math/" class="md-tabs__link">
          
  
  
    
  
  Math

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../string/" class="md-tabs__link">
          
  
  
    
  
  String

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../theory/" class="md-tabs__link">
          
  
  
    
  
  Theory

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../codeforces/" class="md-tabs__link">
          
  
  
    
  
  Codeforces

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../gmoj/" class="md-tabs__link">
          
  
  
    
  
  GMOJ

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../record/" class="md-tabs__link">
          
  
  
    
  
  Record

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../misc/" class="md-tabs__link">
          
  
  
    
  
  Misc

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Liam&#39;s Blog" class="md-nav__button md-logo" aria-label="Liam's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.15 19h-5.76v-2.13c2.11-1.62 3.2-3.63 3.2-6.03 0-1.5-.43-2.68-1.27-3.55C14.47 6.42 13.37 6 12.03 6c-1.35 0-2.46.42-3.32 1.3-.87.87-1.3 2.07-1.3 3.58 0 2.38 1.09 4.38 3.2 5.99V19H4.85v-2.13h3.56c-2.37-1.55-3.56-3.64-3.56-6.27 0-2.1.65-3.74 1.96-4.94 1.31-1.21 3.03-1.81 5.16-1.81 2.18 0 3.92.6 5.22 1.79 1.31 1.19 1.96 2.86 1.96 4.94 0 2.63-1.2 4.73-3.6 6.29h3.6z"/></svg>

    </a>
    Liam's Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lnw143/blog" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    blog
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    主页
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            主页
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    归档
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            归档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2025
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
      
    
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    2024
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="../../" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    2024
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#平面直角坐标系的点绕原点旋转公式及证明" class="md-nav__link">
    <span class="md-ellipsis">
      平面直角坐标系的点绕原点旋转公式及证明
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sincosalphabeta-的展开证明" class="md-nav__link">
    <span class="md-ellipsis">
      \(\sin/\cos(\alpha+\beta)\) 的展开证明
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rm-FWT-Fast-Walsh-Transform-学习笔记" class="md-nav__link">
    <span class="md-ellipsis">
      \(\rm FWT\) (Fast Walsh Transform) 学习笔记
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#FMTFast-Möbius-Transform-学习笔记" class="md-nav__link">
    <span class="md-ellipsis">
      FMT(Fast Möbius Transform) 学习笔记
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#AtCoder-训练记录" class="md-nav__link">
    <span class="md-ellipsis">
      AtCoder 训练记录
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    分类
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            分类
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/codeforces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Codeforces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/gmoj/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GMOJ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Geometry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/math/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Math
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/misc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/number-theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Number Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/poly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Poly
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/record/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Record
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/string/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    String
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../geometry/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Geometry
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Geometry
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../poly/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Poly
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Poly
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../number-theory/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Number Theory
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Number Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../math/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Math
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Math
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../string/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    String
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            String
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../theory/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../codeforces/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Codeforces
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Codeforces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../gmoj/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    GMOJ
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            GMOJ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../record/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Record
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Record
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../misc/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Misc
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#平面直角坐标系的点绕原点旋转公式及证明" class="md-nav__link">
    <span class="md-ellipsis">
      平面直角坐标系的点绕原点旋转公式及证明
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sincosalphabeta-的展开证明" class="md-nav__link">
    <span class="md-ellipsis">
      \(\sin/\cos(\alpha+\beta)\) 的展开证明
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rm-FWT-Fast-Walsh-Transform-学习笔记" class="md-nav__link">
    <span class="md-ellipsis">
      \(\rm FWT\) (Fast Walsh Transform) 学习笔记
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#FMTFast-Möbius-Transform-学习笔记" class="md-nav__link">
    <span class="md-ellipsis">
      FMT(Fast Möbius Transform) 学习笔记
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#AtCoder-训练记录" class="md-nav__link">
    <span class="md-ellipsis">
      AtCoder 训练记录
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="2024">2024</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/lnw143.png" alt="Liam">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-06-16 00:00:00+00:00">2024年6月16日</time></li>
        
          <li class="md-meta__item">
            分类于
            
              <a href="../../../../category/geometry/" class="md-meta__link">Geometry</a></li>
        
        
          
          <li class="md-meta__item">
            
              需要 1 分钟阅读时间
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="平面直角坐标系的点绕原点旋转公式及证明"><a class="toclink" href="../../../../geometry/rotate-point/">平面直角坐标系的点绕原点旋转公式及证明</a></h2>
<p>设点 <span class="arithmatex">\(A(x,y)\)</span> 绕原点 <span class="arithmatex">\(O(0,0)\)</span> 逆时针旋转 <span class="arithmatex">\(\beta\)</span>，则设在极坐标系下 <span class="arithmatex">\(A\)</span> 的坐标为 <span class="arithmatex">\((r,\alpha)\)</span></p>
<blockquote>
<p>这意味着 <span class="arithmatex">\(x=r \cos \alpha, y=r \sin \alpha\)</span></p>
</blockquote>
<p>目标点 <span class="arithmatex">\(A'(x',y')\)</span> 的极坐标即为 <span class="arithmatex">\((r,\alpha + \beta)\)</span></p>
<p>展开（其中 <span class="arithmatex">\(\sin\)</span> 和 <span class="arithmatex">\(\cos\)</span> 的展开参考 <a href="../../../../geometry/sin-cos-exp/">here</a>）：</p>
<hr />
<div class="arithmatex">\[
\begin{aligned}
x' &amp; = r \cos (\alpha + \beta) \\
&amp; = r(\cos \alpha \cos \beta - \sin \alpha \sin \beta) \\
&amp; = r\cos \alpha \cos \beta - r\sin \alpha \sin \beta \\
&amp; = x \cos \beta - y \sin \beta \\
\end{aligned}
\]</div>
<hr />
<div class="arithmatex">\[
\begin{aligned}
y' &amp; = r \sin (\alpha + \beta) \\
&amp; = r (\sin \alpha \cos \beta + \cos \alpha \sin \beta) \\
&amp; = r \sin \alpha \cos \beta + r\cos \alpha \sin \beta \\
&amp; = y \cos \beta + x \sin \beta\\
\end{aligned}
\]</div>
<hr />
<p>结论：点 <span class="arithmatex">\((x,y)\)</span> 绕原点逆时针旋转 <span class="arithmatex">\(\theta\)</span> 后坐标为 <span class="arithmatex">\((x \cos \theta - y \sin \theta, x \sin \theta + y \cos \theta)\)</span>。</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/lnw143.png" alt="Liam">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-06-16 00:00:00+00:00">2024年6月16日</time></li>
        
          <li class="md-meta__item">
            分类于
            
              <a href="../../../../category/geometry/" class="md-meta__link">Geometry</a></li>
        
        
          
          <li class="md-meta__item">
            
              需要 1 分钟阅读时间
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="sincosalphabeta-的展开证明"><a class="toclink" href="../../../../geometry/sin-cos-exp/"><span class="arithmatex">\(\sin/\cos(\alpha+\beta)\)</span> 的展开证明</a></h2>
<p><a href="https://www.desmos.com/calculator/wd6yildrwt">图</a></p>
<hr />
<div class="arithmatex">\[
\begin{aligned}
\cos(α+β) &amp;= OB \\
&amp; = OD - BD \\
&amp; = OD - EC \\
&amp; = OC \cos \beta - AC \sin \beta \\
&amp; = OA \cos \alpha \cos \beta - OA \sin \alpha \sin \beta \\
&amp; = \cos \alpha \cos \beta - \sin \alpha \sin \beta
\end{aligned}
\]</div>
<hr />
<div class="arithmatex">\[
\begin{aligned}
\sin(α+β) &amp;= AB \\
&amp; = AE + BE \\
&amp; = AE + CD \\
&amp; = AC \cos \beta + OC \sin \beta \\
&amp; = OA \sin \alpha \cos \beta + OA \cos \alpha \sin \beta \\
&amp; = \sin \alpha \cos \beta + \cos \alpha \sin \beta \\
\end{aligned}
\]</div>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/lnw143.png" alt="Liam">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-30 00:00:00+00:00">2024年4月30日</time></li>
        
          <li class="md-meta__item">
            分类于
            
              <a href="../../../../category/poly/" class="md-meta__link">Poly</a></li>
        
        
          
          <li class="md-meta__item">
            
              需要 5 分钟阅读时间
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="rm-FWT-Fast-Walsh-Transform-学习笔记"><a class="toclink" href="../../../../poly/fwt/"><span class="arithmatex">\(\rm FWT\)</span> (Fast Walsh Transform) 学习笔记</a></h2>
<blockquote>
<p>本文中使用 <span class="arithmatex">\(\cap\)</span> 表示按位与，用 <span class="arithmatex">\(\cup\)</span> 表示按位或</p>
</blockquote>
<h3 id="与或-卷积"><a class="toclink" href="../../../../poly/fwt/#与或-卷积">与/或 卷积</a></h3>
<h4 id="问题引入"><a class="toclink" href="../../../../poly/fwt/#问题引入">问题引入</a></h4>
<p>给定长度为 <span class="arithmatex">\(2^n\)</span> 的数列 <span class="arithmatex">\(A,B\)</span>，求 <span class="arithmatex">\(C_i = \sum_{j \cup k = i} A_j \times B_k\)</span></p>
<p>显然有 <span class="arithmatex">\(O(4^n)\)</span> 的暴力</p>
<h4 id="正变换"><a class="toclink" href="../../../../poly/fwt/#正变换">正变换</a></h4>
<p>这一部分可以参考 <a href="../../../../poly/fmt/#zeta-变换">FMT 中的 Zeta 变换</a> ，即定义 <span class="arithmatex">\(\hat A_i\)</span> 为序列 <span class="arithmatex">\(A\)</span> 中 <span class="arithmatex">\(i\)</span> 的子集和</p>
<h4 id="快速变换"><a class="toclink" href="../../../../poly/fwt/#快速变换">快速变换</a></h4>
<p>考虑分治</p>
<p>对于长度为 <span class="arithmatex">\(2^n\)</span> 的待求解的 <span class="arithmatex">\(\hat A\)</span>，我们把它分成独立的两部分，即 <span class="arithmatex">\([0,2^{n-1})\)</span> 和 <span class="arithmatex">\([2^{n-1},2^n)\)</span> 两个区间分别求解</p>
<p>然后考虑这两个区间之间的贡献，发现只有 <span class="arithmatex">\([0,2^{n-1})\)</span> 对 <span class="arithmatex">\([2^{n-1},2^n)\)</span> 有贡献，于是对于 <span class="arithmatex">\(i \in [0,2^{n-1})\)</span>，将 <span class="arithmatex">\(\hat A_{i}\)</span> 加到 <span class="arithmatex">\(\hat A_{i+2^{n-1}}\)</span> 中即可</p>
<p>时间复杂度 <span class="arithmatex">\(O(n 2^n)\)</span></p>
<h4 id="逆变换"><a class="toclink" href="../../../../poly/fwt/#逆变换">逆变换</a></h4>
<p>我们只需要对照正变换中的操作步骤，一步一步撤销变换即可</p>
<p>即对于 <span class="arithmatex">\(i \in [0,2^{n-1})\)</span>，将 <span class="arithmatex">\(\hat A_{i+2^{n-1}}\)</span> 减去 <span class="arithmatex">\(\hat A_{i}\)</span> 的贡献，然后再递归地求解</p>
<hr />
<p>当然还有另外的做法，即我们要将长度为 <span class="arithmatex">\(2^n\)</span> 的 <span class="arithmatex">\(\hat A_i\)</span> 在全集为 <span class="arithmatex">\(2^n-1\)</span> 的情况下（即不考虑目前的长度外的子集）只包括自己的 <span class="arithmatex">\(A_i\)</span>，那么我们递归地求解完左右两个区间后，肯定有 <span class="arithmatex">\(\forall i\in [0,2^{n-1}),\hat A_{i+2^{n-1}}=\hat A_i+A_{i+2^{n-1}}\)</span>，因此减去贡献即可</p>
<p>in brief，可以先递归再减贡献，这样逆变换与正变换只有一个 <code>+/-</code> 的变化</p>
<h4 id="推广"><a class="toclink" href="../../../../poly/fwt/#推广">推广</a></h4>
<p>对于 <span class="arithmatex">\(\cap\)</span> 的情况，与 <span class="arithmatex">\(\cup\)</span> 十分相似，请读者尽量自己构造变换，推一下式子，可以加深理解</p>
<p>如果没有思路，<a href="https://oi-wiki.org/math/poly/fwt/#%E4%B8%8E%E8%BF%90%E7%AE%97">here</a></p>
<h3 id="异或-卷积"><a class="toclink" href="../../../../poly/fwt/#异或-卷积">异或 卷积</a></h3>
<h4 id="问题引入_1"><a class="toclink" href="../../../../poly/fwt/#问题引入_1">问题引入</a></h4>
<p>给定长度为 <span class="arithmatex">\(2^n\)</span> 的数列 <span class="arithmatex">\(A,B\)</span>，求 <span class="arithmatex">\(C_i = \sum_{j \oplus k = i} A_j \times B_k\)</span></p>
<h4 id="原理"><a class="toclink" href="../../../../poly/fwt/#原理">原理</a></h4>
<p>设 <span class="arithmatex">\(\operatorname{popcnt}(i)\)</span> 表示 <span class="arithmatex">\(i\)</span> 在二进制下 <code>1</code> 的个数，则有</p>
<div class="arithmatex">\[
\operatorname{popcnt}(i \cap k) + \operatorname{popcnt}(j \cap k) \equiv \operatorname{popcnt}((i\oplus j)\cap k) \pmod 2
\]</div>
<blockquote>
<p>证明：显然 <span class="arithmatex">\(k\)</span> 为 <span class="arithmatex">\(0\)</span> 的位上，<span class="arithmatex">\(i,j\)</span> 的取值不影响结果，那么设 <span class="arithmatex">\(i'=i\cap k,j'=j\cap k\)</span>，那么问题转化为
$$
\operatorname{popcnt}(i') + \operatorname{popcnt}(j') \equiv \operatorname{popcnt}(i'\oplus j') \pmod 2
$$
对于 <span class="arithmatex">\(i',j'\)</span> 每一位分开讨论，原命题易证</p>
</blockquote>
<p>即异或不会改变 <span class="arithmatex">\(1\)</span> 的总数的奇偶性</p>
<h4 id="正变换_1"><a class="toclink" href="../../../../poly/fwt/#正变换_1">正变换</a></h4>
<p>我们尝试构造一个变换
$$
\hat A_i = \sum_j g(i,j) A_j
$$
例如对于 <span class="arithmatex">\(\cup\)</span> 卷积 ，<span class="arithmatex">\(g(i,j)=[i\cup j=i]\)</span></p>
<p>这个 <span class="arithmatex">\(g\)</span> 函数满足以下性质：</p>
<div class="arithmatex">\[
\begin{aligned}
&amp; \because \hat C_i = \hat A_i \times \hat B_i \\
&amp; \therefore \sum_{p} g(i,p)C_p = \sum_{j,k} g(i,j)\times g(i,k)\times A_j \times B_k \\
&amp; \therefore \sum_{p} g(i,p) \sum_{j \oplus k = p} A_j \times B_k = \sum_{j,k} g(i,j)\times g(i,k)\times A_j \times B_k \\
&amp; \therefore \sum_{j,k} g(i,j \oplus k) A_j \times B_k = \sum_{j,k} g(i,j)\times g(i,k)\times A_j \times B_k
\end{aligned}
\]</div>
<p>即我们要使得 <span class="arithmatex">\(g(i,j)\times g(i,k) = g(i,j \oplus k)\)</span></p>
<p>因为 <span class="arithmatex">\(\operatorname{popcnt}(i \cap k) + \operatorname{popcnt}(j \cap k) \equiv \operatorname{popcnt}((i\oplus j)\cap k) \pmod 2\)</span>，我们发现 <span class="arithmatex">\(g(i,j) = (-1)^{\operatorname{popcnt}(i \cap j)}\)</span> 满足这个性质</p>
<div class="arithmatex">\[
\hat A_i = \sum_j (-1)^{\operatorname{popcnt}(i \cap j)} A_j
\]</div>
<p>手动推一下式子：</p>
<div class="arithmatex">\[
\begin{aligned}
\hat A_i \times \hat B_i &amp; = \sum_j g(i,j)A_j \times \sum_k g(i,k) B_k\\
&amp; = \sum_j (-1)^{\operatorname{popcnt}(i \cap j)} A_j \times \sum_k (-1)^{\operatorname{popcnt}(i \cap k)} B_k\\
&amp; = \sum_{j,k} (-1)^{\operatorname{popcnt}(i \cap j) + \operatorname{popcnt}(i \cap k)} A_j \times B_k \\
&amp; = \sum_{j,k} (-1)^{\operatorname{popcnt}(i \cap (j \oplus k))} C_{j \oplus k} \\
&amp; = \sum_{p} (-1)^{\operatorname{popcnt}(i \cap p)} C_p \\
&amp; = \sum_p g(i,p) C_p \\
&amp; = \hat C_i
\end{aligned}
\]</div>
<h4 id="快速变换_1"><a class="toclink" href="../../../../poly/fwt/#快速变换_1">快速变换</a></h4>
<p>有点抽象，画个 <span class="arithmatex">\(n=3\)</span> 的图来模拟一下</p>
<p><img alt="快速变换图解" src="../../../../algo/poly/fwt-1.svg" /></p>
<p>假设现在我们要考虑从 <span class="arithmatex">\(n=2\)</span> 到 <span class="arithmatex">\(n=3\)</span> 的变换，我们发现左边是 <code>0??</code>，右边是 <code>1??</code>，分别多出一个最高位</p>
<p>设原变换为 <span class="arithmatex">\(F_i\)</span> ，目标变换为 <span class="arithmatex">\(G_i\)</span></p>
<ul>
<li>左 <span class="arithmatex">\(\to\)</span> 左</li>
</ul>
<p>我们发现左边内部之间的 <span class="arithmatex">\(\cap\)</span> 结果不变，因此 <span class="arithmatex">\(\forall i&lt;4, G_i \gets F_i\)</span></p>
<ul>
<li>左 <span class="arithmatex">\(\to\)</span> 右 / 右 <span class="arithmatex">\(\to\)</span> 左</li>
</ul>
<p>我们发现 <code>0??</code> <span class="arithmatex">\(\cap\)</span> <code>1??</code> = <code>0??</code>，因此其 <code>1</code> 的个数不变，因此 <span class="arithmatex">\(\forall i&lt;4,G_i \gets F_{i+4}, G_{i+4} \gets F_i\)</span>。</p>
<ul>
<li>右 <span class="arithmatex">\(\to\)</span> 右</li>
</ul>
<p>我们发现之前是 <code>??</code> <span class="arithmatex">\(\cap\)</span> <code>??</code> = <code>??</code>，但是现在在前面加了一个 <code>1</code>，因此 <span class="arithmatex">\(-1\)</span> 的指数加一，所以 <span class="arithmatex">\(\forall i&lt;4,G_{i+4} \gets -F_{i+4}\)</span></p>
<p>综上，我们有 <span class="arithmatex">\(\forall i&lt;4,G_i=F_i+F_{i+4}, G_{i+4}=F_i-F_{i+4}\)</span></p>
<p>generally，对于从 <span class="arithmatex">\(n-1\)</span> 到 <span class="arithmatex">\(n\)</span> 的变换，我们有 </p>
<div class="arithmatex">\[
\forall i&lt;2^{n-1}, G_i=F_i+F_{i+2^{n-1}}, G_{i+2^{n-1}}=F_i-F_{i+2^{n-1}}
\]</div>
<p>时间复杂度 <span class="arithmatex">\(O(n2^n)\)</span>。</p>
<h4 id="逆变换_1"><a class="toclink" href="../../../../poly/fwt/#逆变换_1">逆变换</a></h4>
<p>对照上面式子易得 <del>（留给读者思考）</del></p>
<h3 id="模板题"><a class="toclink" href="../../../../poly/fwt/#模板题"><a href="https://www.luogu.com.cn/problem/P4717">模板题</a></a></h3>
<p>核心代码如下</p>
<div class="language-cpp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><span class="kt">void</span><span class="w"> </span><span class="nf">fwtOr</span><span class="p">(</span><span class="n">ll</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-2"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-2-3"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="n">j</span><span class="o">+=</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-2-4"><span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span>
</span><span id="__span-2-5"><span class="w">                </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">type</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">])</span><span class="o">%=</span><span class="n">P</span><span class="p">;</span>
</span><span id="__span-2-6"><span class="p">}</span>
</span><span id="__span-2-7"><span class="kt">void</span><span class="w"> </span><span class="nf">fwtAnd</span><span class="p">(</span><span class="n">ll</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-8"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-2-9"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="n">j</span><span class="o">+=</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-2-10"><span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span>
</span><span id="__span-2-11"><span class="w">                </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">+=</span><span class="n">type</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">i</span><span class="p">])</span><span class="o">%=</span><span class="n">P</span><span class="p">;</span>
</span><span id="__span-2-12"><span class="p">}</span>
</span><span id="__span-2-13"><span class="kt">void</span><span class="w"> </span><span class="nf">fwtXor</span><span class="p">(</span><span class="n">ll</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-14"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-2-15"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="n">j</span><span class="o">+=</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-2-16"><span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-17"><span class="w">                </span><span class="n">ll</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">],</span><span class="n">v</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">i</span><span class="p">];</span>
</span><span id="__span-2-18"><span class="w">                </span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">+</span><span class="n">v</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
</span><span id="__span-2-19"><span class="w">                </span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">-</span><span class="n">v</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="p">;</span>
</span><span id="__span-2-20"><span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">type</span><span class="o">==</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-21"><span class="w">                    </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">*=</span><span class="n">Pi2</span><span class="p">)</span><span class="o">%=</span><span class="n">P</span><span class="p">;</span>
</span><span id="__span-2-22"><span class="w">                    </span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="o">*=</span><span class="n">Pi2</span><span class="p">)</span><span class="o">%=</span><span class="n">P</span><span class="p">;</span>
</span><span id="__span-2-23"><span class="w">                </span><span class="p">}</span>
</span><span id="__span-2-24"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-2-25"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="进阶理解"><a class="toclink" href="../../../../poly/fwt/#进阶理解">进阶理解</a></h3>
<p><span class="arithmatex">\(\rm FWT\)</span> 的变换本质实际上是构造 <span class="arithmatex">\(g\)</span> 的过程。</p>
<p>设 <span class="arithmatex">\(\hat A_i = \sum_j g(i,j) A_j\)</span>，那么这个 <span class="arithmatex">\(n \times n\)</span> 的 <span class="arithmatex">\(\lceil\)</span>转移矩阵<span class="arithmatex">\(\rfloor\)</span> 被称为位矩阵。</p>
<p>对于不同的卷积形式，我们需要构造不同的位矩阵。</p>
<p>特别注意由于我们需要逆变换，因此矩阵必须有逆。</p>
<p>形式化地，对于 <span class="arithmatex">\(\odot\)</span> 卷积，即 <span class="arithmatex">\(C_i = \sum_{j \odot k = i} A_j B_k\)</span>，我们需要构造如下位矩阵：</p>
<div class="arithmatex">\[
\begin{aligned}
&amp; \hat C_i = \hat A_i \hat B_i \\
\iff &amp; \sum_j g(i,j) C_j = \sum_j g(i,j) A_j \sum_k g(i,k) B_k \\
\iff &amp; \sum_j g(i,j) C_j = \sum_j \sum_k g(i,j) g(i,k) A_j B_k \\
\iff &amp; g(i,j \odot k) = g(i,j) g(i,k)
\end{aligned}
\]</div>
<p>写的不是很严谨，请读者自己手推一下。</p>
<p>对于上文的三类卷积，其位矩阵的构造显然为</p>
<div class="arithmatex">\[
g_{\cup}(i,j) = [i \cup j = i] \\
g_{\cap}(i,j) = [i \cap j = i] \\
g_{\oplus}(i,j) = (-1)^{\mathrm{popcnt} (i \cap j)}
\]</div>
<h3 id="rm-FWT-的线性性"><a class="toclink" href="../../../../poly/fwt/#rm-FWT-的线性性"><span class="arithmatex">\(\rm FWT\)</span> 的线性性</a></h3>
<p>设 <span class="arithmatex">\(\mathrm{FWT}(A)_i = \hat A_i = \sum_j g(i,j) A_j\)</span>，则有如下引理。</p>
<details class="note">
<summary><span class="arithmatex">\(\mathrm{FWT}(A+B) = \mathrm{FWT}(A) + \mathrm{FWT}(B)\)</span></summary>
<p>根据公式显然。</p>
</details>
<details class="note">
<summary><span class="arithmatex">\(\mathrm{FWT}(cA) = c\mathrm{FWT}(A)\)</span></summary>
<p>这个也是显然（</p>
</details>
<details class="note">
<summary><span class="arithmatex">\(\mathrm{FWT}(A^{-1})_i = g(i,0) \mathrm{FWT}(A)_i^{-1}\)</span></summary>
<div class="arithmatex">\[
\begin{aligned}
&amp; \mathrm{FWT}(A^{-1})_i \mathrm{FWT}(A)_i \\
&amp; = \sum_j g(i,j) A^{-1}_j \sum_k g(i,k) A_k \\
&amp; = \sum_j \sum_k g(i,j \odot k) A^{-1}_j A_k \\
&amp; = \sum_{p} g(i,p) \sum_{j \odot k = p} A^{-1}_j A_k \\
&amp; = \sum_{p} g(i,p) [p=0] \\
&amp; = g(i,0) \\
\end{aligned}
\]</div>
</details>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/lnw143.png" alt="Liam">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-24 00:00:00+00:00">2024年4月24日</time></li>
        
          <li class="md-meta__item">
            分类于
            
              <a href="../../../../category/poly/" class="md-meta__link">Poly</a></li>
        
        
          
          <li class="md-meta__item">
            
              需要 3 分钟阅读时间
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="FMTFast-Möbius-Transform-学习笔记"><a class="toclink" href="../../../../poly/fmt/">FMT(Fast Möbius Transform) 学习笔记</a></h2>
<blockquote>
<p>小 Tips：在计算机语言中 <span class="arithmatex">\(\cap\)</span> = <code>&amp;</code> / <code>and</code>， <span class="arithmatex">\(\cup\)</span> = <code>|</code> / <code>or</code></p>
</blockquote>
<h3 id="定义"><a class="toclink" href="../../../../poly/fmt/#定义">定义</a></h3>
<p>定义长度为 <span class="arithmatex">\(2^n\)</span> 的序列的 <code>and</code> 卷积 <span class="arithmatex">\(A = B * C\)</span> 为 <span class="arithmatex">\(A_i=\sum_{j \cap k = i}{B_j \times C_k}\)</span></p>
<p>考虑快速计算</p>
<h3 id="Zeta-变换"><a class="toclink" href="../../../../poly/fmt/#Zeta-变换">Zeta 变换</a></h3>
<p>定义长度为 <span class="arithmatex">\(2^n\)</span> 的序列的 <code>Zeta 变换</code> 为</p>
<div class="arithmatex">\[
\hat A_i = \sum_{j \subseteq i}{A_j}
\]</div>
<p>即子集和</p>
<p>它具有一下性质：</p>
<div class="arithmatex">\[
\hat B_i \times \hat C_i
= \sum_{j \subseteq i} B_j \times \sum_{k \subseteq i} C_k
= \sum_{p \subseteq i} \sum_{j \cap k = p} B_j \times C_k
= \sum_{p \subseteq i} A_p = \hat A_i
\]</div>
<p>相当于 <code>FFT</code> 中的点值表示法，用以加速卷积过程</p>
<h3 id="快速变换"><a class="toclink" href="../../../../poly/fmt/#快速变换">快速变换</a></h3>
<p>暴力求解 <span class="arithmatex">\(\hat A\)</span> 最优时间复杂度为 <span class="arithmatex">\(3^n\)</span>，考虑加速</p>
<p>考虑 <code>子集DP</code> ，有一篇很好的博客<sup id="fnref3:1"><a class="footnote-ref" href="../../../../poly/fmt/#fn:1">1</a></sup>，这里大概讲解一下。</p>
<p>其实 <span class="arithmatex">\(\hat A\)</span> 本质上是一个高维（<span class="arithmatex">\(n\)</span> 维）前缀和</p>
<p>如果我们要求二维前缀和，显然可以通过一下代码实现：</p>
<div class="language-cpp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><span class="c1">// 1st</span>
</span><span id="__span-10-2"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-10-3"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span><span id="__span-10-4"><span class="w">            </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
</span><span id="__span-10-5"><span class="c1">// 2nd</span>
</span><span id="__span-10-6"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-10-7"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span><span id="__span-10-8"><span class="w">            </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="mi">-1</span><span class="p">];</span>
</span></code></pre></div></td></tr></table></div>
<p>我们发现 <code>1st</code> 完成后 <code>a[i][j]</code> 表示的是 <span class="arithmatex">\(\sum_{k \le i} a_{k,j}\)</span>，即 <span class="arithmatex">\((i,j)\)</span> 上方的元素和</p>
<p>那么 <code>2nd</code> 便是将 <span class="arithmatex">\((i,j)\)</span> 左边操作后的 <span class="arithmatex">\(\sum_{k \le j} a_{i,k}\)</span> 累加到 <code>a[i][j]</code> 中，即完成二维前缀和</p>
<hr />
<p>下面拓展到三维前缀和</p>
<div class="language-cpp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><span class="c1">// 1st</span>
</span><span id="__span-11-2"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-11-3"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span><span id="__span-11-4"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span>
</span><span id="__span-11-5"><span class="w">            </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
</span><span id="__span-11-6"><span class="c1">// 2nd</span>
</span><span id="__span-11-7"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-11-8"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span><span id="__span-11-9"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span>
</span><span id="__span-11-10"><span class="w">            </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="mi">-1</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
</span><span id="__span-11-11"><span class="c1">// 3rd</span>
</span><span id="__span-11-12"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-11-13"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span><span id="__span-11-14"><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span>
</span><span id="__span-11-15"><span class="w">            </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="mi">-1</span><span class="p">];</span>
</span></code></pre></div></td></tr></table></div>
<p>类似地，<code>1st,2nd</code> 中处理除了第 <code>k</code> 平面中的二维前缀和，<code>3rd</code> 在立体空间中把他们加起来，成为三维前缀和</p>
<hr />
<p>回到 <code>Zeta 变换</code>：</p>
<div class="arithmatex">\[
\hat A_i = \sum_{j \subseteq i}{A_j}
\]</div>
<p>如果我们用二进制 <span class="arithmatex">\((x_{n-1}x_{n-2}x_{n-3}\ ...\ x_2x_1x_0)_2\)</span> 表示集合 <span class="arithmatex">\(i\)</span>，二进制 <span class="arithmatex">\((y_{n-1}y_{n-2}y_{n-3}\ ...\ y_2y_1y_0)_2\)</span> 表示集合 <span class="arithmatex">\(j\)</span></p>
<p>那么 <span class="arithmatex">\(\hat A_i\)</span> 可以被视为 <span class="arithmatex">\(n\)</span> 维前缀和，即 
$$
\hat A_i = \sum_{y_{n-1}\le x_{n-1},y_{n-2}\le x_{n-2}, ..., y_1\le x_1,y_0\le x_0} A_j
$$</p>
<p>当然，下标都为 <code>0/1</code></p>
<p>因此，我们有如下 Code：</p>
<div class="language-cpp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-12-2"><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span><span id="__span-12-3"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">&amp;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="p">))</span>
</span><span id="__span-12-4"><span class="w">            </span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="p">)];</span>
</span></code></pre></div></td></tr></table></div>
<p>以上 Code 的 naive 形式为：</p>
<div class="language-cpp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i1</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i1</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i2</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">in</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">in</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">i1</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">][...][</span><span class="n">in</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="mi">-1</span><span class="p">][</span><span class="n">i2</span><span class="p">][...][</span><span class="n">in</span><span class="p">];</span>
</span><span id="__span-13-2"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i1</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i1</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i2</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">in</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">in</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">i2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">][...][</span><span class="n">in</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="mi">-2</span><span class="p">][...][</span><span class="n">in</span><span class="p">];</span>
</span><span id="__span-13-3"><span class="p">...</span>
</span><span id="__span-13-4"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i1</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i1</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i2</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">in</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">in</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">in</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">][...][</span><span class="n">in</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">][...][</span><span class="n">in</span><span class="mi">-1</span><span class="p">];</span>
</span></code></pre></div></td></tr></table></div>
<p><del>不要质疑我代码编译不通过</del></p>
<p>因此，我们用 <span class="arithmatex">\(O(n2^n)\)</span> 的时间复杂度解决了 <code>Zeta 变换</code></p>
<h3 id="逆变换"><a class="toclink" href="../../../../poly/fmt/#逆变换">逆变换</a></h3>
<blockquote>
<p>warning：此处不是 <code>莫比乌斯反演</code>！</p>
</blockquote>
<p>众所周知，前缀和的逆运算即为差分</p>
<p>我们发现，只需要先将最后一维差分，即可将序列处理为 <span class="arithmatex">\(n-1\)</span> 维前缀和</p>
<p>即</p>
<div class="language-cpp highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i1</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i1</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i2</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">in</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">in</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">in</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">][...][</span><span class="n">in</span><span class="p">]</span><span class="o">-=</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">][...][</span><span class="n">in</span><span class="mi">-1</span><span class="p">];</span>
</span><span id="__span-14-2"><span class="p">...</span>
</span><span id="__span-14-3"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i1</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i1</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i2</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">in</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">in</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">i2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">][...][</span><span class="n">in</span><span class="p">]</span><span class="o">-=</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="mi">-2</span><span class="p">][...][</span><span class="n">in</span><span class="p">];</span>
</span><span id="__span-14-4"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i1</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i1</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i2</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">in</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">in</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">i1</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="p">][</span><span class="n">i2</span><span class="p">][...][</span><span class="n">in</span><span class="p">]</span><span class="o">-=</span><span class="n">a</span><span class="p">[</span><span class="n">i1</span><span class="mi">-1</span><span class="p">][</span><span class="n">i2</span><span class="p">][...][</span><span class="n">in</span><span class="p">];</span>
</span></code></pre></div></td></tr></table></div>
<p>但实际上因为前缀和都是无序的，因此我们直接正着做就可以啦</p>
<p>只需要把正变换的 <code>+=</code> 改为 <code>-=</code> 就可以了</p>
<h3 id="扩展"><a class="toclink" href="../../../../poly/fmt/#扩展">扩展</a></h3>
<p>有时候，题目给的不是 <span class="arithmatex">\(\cap\)</span> ，而是 <span class="arithmatex">\(\cup\)</span> 怎么办？</p>
<p>那我们重定义 <code>Zeta 变换</code> 为：
$$
\hat A_i = \sum_{i \supseteq j} A_j
$$
再推一下式子：
$$
\hat B_i \times \hat C_i
=\sum_{i\supseteq j} B_j \times \sum_{i\supseteq k} C_k
=\sum_{i\supseteq j,i\supseteq k} B_j \times C_k
=\sum_{i\supseteq p} \sum_{j \cup k=p} B_j \times C_k
=\sum_{i\supseteq p} A_p
=\hat A_i
$$
变换即超集和，高维后缀和</p>
<p>求法也很简单，只用将源代码中的 <code>if(j&amp;(1&lt;&lt;i))</code> 该为 <code>if(!(j&amp;(1&lt;&lt;i)))</code> 即可</p>
<hr />
<p>是 <span class="arithmatex">\(\oplus\)</span> 怎么办？</p>
<p><del>快去学 <a href="../../../../poly/fwt/">FWT</a> 吧</del></p>
<h3 id="例题"><a class="toclink" href="../../../../poly/fmt/#例题">例题</a></h3>
<ul>
<li><a href="https://atcoder.jp/contests/abc349/tasks/abc349_f">ABC349F</a></li>
</ul>
<blockquote>
<p>再送你一个并/交集的小口诀：下并或，上交与</p>
</blockquote>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="https://www.cnblogs.com/heyuhhh/p/11585358.html">高维前缀和总结(sosdp) - heyuhhh - 博客园 (cnblogs.com)</a>&#160;<a class="footnote-backref" href="../../../../poly/fmt/#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="../../../../poly/fmt/#fnref2:1" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="../../../../poly/fmt/#fnref3:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/lnw143.png" alt="Liam">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-21 00:00:00+00:00">2024年4月21日</time></li>
        
          <li class="md-meta__item">
            分类于
            
              <a href="../../../../category/record/" class="md-meta__link">Record</a></li>
        
        
          
          <li class="md-meta__item">
            
              需要 2 分钟阅读时间
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="AtCoder-训练记录"><a class="toclink" href="../../../../record/atcoder/">AtCoder 训练记录</a></h2>
<p><del><a href="https://atcoder.jp/users/lnw143">先贴上本人主页</a></del></p>
<h3 id="ABC347"><a class="toclink" href="../../../../record/atcoder/#ABC347"><a href="https://atcoder.jp/contests/abc347/standings?watching=lnw143">ABC347</a></a></h3>
<p><span class="arithmatex">\(\Delta=\color{red}{-24}\)</span></p>
<p><del>蓝名保卫战，极限 1600</del></p>
<p>C 题还是有些思维难度的，最后才做出来，但是不够简洁</p>
<p>E 题忘开 <code>%lld</code> 喜提罚时</p>
<p>D 题最难评，又 WA 又 RE，最后如果输出不符合条件就输出 <code>-1</code> 才过</p>
<p>F 题<a href="https://www.luogu.com.cn/problem/P3625">原题</a>，但是不会（</p>
<p>赛后发现就是一个二维前缀和 + 二位前缀max，还是挺简单的</p>
<p><del>G 题不会</del></p>
<p>赛时打的太急了，罚时太多，速度也被拖慢了，同分的最高 <code>performance</code> 有 2000+，还是代码实现不够快和准</p>
<h3 id="AGC066"><a class="toclink" href="../../../../record/atcoder/#AGC066"><a href="https://atcoder.jp/contests/agc066/standings?watching=lnw143">AGC066</a></a></h3>
<p><span class="arithmatex">\(\Delta=\color{red}{-21}\)</span></p>
<p><del>E 题原题，还抓了一个抄题解的</del></p>
<p>A 题还是挺水的，只是没想到从奇偶性的角度来想，题解给的是 <span class="arithmatex">\(O(N ^ 2 D)\)</span> 的做法，但是有更优且更简单的做法 <span class="arithmatex">\(O(N ^ 2)\)</span>，但是没想到，还是考思维。</p>
<p>B 题有点愚人节，<code>python</code> 语言优势很大（自带高精度），用几个 <span class="arithmatex">\(5 ^ x\)</span> 拼起来多随机几次就完了，难绷（</p>
<p><del>蓝名没了 /ll</del></p>
<h3 id="ABC348"><a class="toclink" href="../../../../record/atcoder/#ABC348"><a href="https://atcoder.jp/contests/abc348/standings?watching=lnw143">ABC348</a></a></h3>
<p><span class="arithmatex">\(\Delta=\color{green}{114}\)</span></p>
<p><code>performance</code> 2300+ 祭</p>
<p>0罚时切 A ~ F，<del>让我又想起了那场似的 rating</del></p>
<p>F 题听说比较水，暴力 + O3 可过，但是我用 <code>bitset</code> <span class="arithmatex">\(O(\frac{N ^ 2 M}{\omega})\)</span> 也过了（</p>
<p>G 题决策单调性优化板题，原题两道：<a href="https://atcoder.jp/contests/joisc2019/tasks/joisc2019_j">here</a> &amp; <a href="https://codeforces.com/problemset/gymProblem/104651/L">here</a> <del>（但我不会）</del></p>
<p>upd on 2024.4.14 : G 题改出来了，应用单调性还是比较简单的，但是难在证明</p>
<h3 id="ABC349"><a class="toclink" href="../../../../record/atcoder/#ABC349"><a href="https://atcoder.jp/contests/abc349/standings?watching=lnw143">ABC349</a></a></h3>
<p><span class="arithmatex">\(\Delta=\color{green}{67}\)</span></p>
<p>A ~ D 都比较顺畅，D 题盲猜 <span class="arithmatex">\(\text{lowbit}\)</span> 喜提机房一血，E 题没开 <code>long long</code> 喜提一发罚时与机房一血</p>
<p>然后就坐着与 F &amp; G 干瞪眼，F 先是用 cdq 尝试水分，后来将不是 <span class="arithmatex">\(M\)</span> 因数的删掉了，还是不行</p>
<p>最后发现 <span class="arithmatex">\(M\)</span> 最多有 <span class="arithmatex">\(13\)</span> 个因数，直接 <span class="arithmatex">\(O(2^{13}N) \approx 1.638 \times 10^9\)</span> 过了，<del>AtCoder 神机</del></p>
<p>但是打得太急，F 题 7 发罚时，最后 4 发最离谱，一发没取模，一发取模太慢 TLE，一发将取模改成减法写错了，最后一发两处取模是 copy 的都错了，漏了一处没改（</p>
<p><span class="arithmatex">\(\color{green}{525} \color{red}{(7)}\)</span> ！！</p>
<p>G 题直接并查集开水，快 T 了就 No，过了一半的数据点</p>
<p>实际上还可以开随机化，因为对于 <span class="arithmatex">\(\forall i\)</span>，有些连边是不需要的，有概率连到与目标解答案相同的状态，但比赛后才想到（</p>
<h3 id="ABC350"><a class="toclink" href="../../../../record/atcoder/#ABC350"><a href="https://atcoder.jp/contests/abc350/standings?watching=lnw143">ABC350</a></a></h3>
<p><span class="arithmatex">\(\Delta=\color{red}{-6}\)</span></p>
<p>之前的总结写的太笼统了，更像是提要。刚好今天实在是打 emo 了，犯了很多离谱的错误，想写一篇个人直观的反思，从 <code>rating</code> 和 <code>performance</code> 中跳出来，慢慢地审视整个过程。</p>
<p>A 题其实没有问题，可以直接A的，但是把 <code>%03d</code> 写成了 <code>%02d</code> 样例中也没有 <code>ABC001</code>，于是就挂了。</p>
<p>后来几道题一直很慌，越慌，越是想打快。越是快，就越出错。这很严重拖慢了整个切题的速度。C 题本来是没什么问题的，但是急着想过掉它，核心的代码几乎一半是错的，第一发直接罚时，这时心情也是很差了，很焦躁。后来逼迫自己冷静下来，又在草稿纸上画了几下，思路便逐渐清晰，于是便改对了。</p>
<p>到了赛点的后三题后，我其实刚刚松一口气，看到 E 题又自闭了，毕竟概率题上次就栽过，是<a href="https://atcoder.jp/contests/abc342/tasks/abc342_f">ABC342F</a>，这次又看到，心里一紧，只好先尝试 F 题。</p>
<p>F 题读完题后没多久就想到了 dfs，然而实现中还是有一些小错误，如 <code>for</code> 循环里更新 <code>i</code> 的话，它实际上还会 <code>++i/--i</code> 一次，会跳过一个位置。好在没罚时。</p>
<p>切完 F 题后看了一下 G 题，一开始读错题了以为那个在线是假的，高高兴兴拿样例试水发现是错的。没办法，于是看 E 题，结果旁边的人 <del>看我蓝名快没了</del> 好心旁敲侧击，于是想到 DP，中途还有一个自己转移到自己的，想到了之前的<a href="https://atcoder.jp/contests/abc333/tasks/abc333_f">一道题目</a> <del>虽然我没改出来</del> ，于是移项解方程即可。</p>
<p>一开始 <span class="arithmatex">\(10^{18}\)</span> 我认为计搜是过不了的，因此打得不够坚定，还有一个变量重名调了很久，实现不够稳和准。开始是想着拿去水分的，但是直接过了，而且时间也很充裕（7ms）。赛后看题解，计搜时间复杂度实际上是 <span class="arithmatex">\(O(\log^3 n)\)</span>，但是主要问题是不会证明，对自己没有信心，于是犹豫了很久。</p>
<p>到了最后的 G 题，此时还剩下 20 分钟，已经机房内有人切了 G 题。出于对 G 题的潜意识压力以及前面比赛的表现，我此时已经基本失去思考能力了，脑子一片嗡嗡的根本想不到正解，打了一个根本就没概率的随机化过了一半，最后遗憾收场。</p>
<p>机房内同年级的有 4 个人过了 G 题，其中 3 人都是水过的，还包括两个代码相似的人。第四个<a href="https://atcoder.jp/contests/abc350/standings?watching=yangjiaxi">大佬</a>用了 <code>splay</code>。</p>
<p>到这里，你可能认为 G 题还是有点难度的。但是，实际上，这也是我在比赛中犯的最后一个，也是最大的一个错误。</p>
<p>读完 <a href="https://atcoder.jp/contests/abc350/tasks/abc350_g">G 题</a>，其实不难想到如果维护好了森林中的每棵树有确定的根（具体是哪个节点与答案无关），并且维护好了每个点在其所在连通块中的朝向这个根的父亲，那么求解答案是 <span class="arithmatex">\(O(1)\)</span> 的。比赛时这个念头在我脑海里一闪而过，但是很快就被否决了——原因很简单，这个维护过程直观上看是非常不可行的。后来，我转而去想 <code>bitset</code> 时间换空间，但一无所获。</p>
<p>然而，这就是问题所在——用暴力维护这些信息实际上的时间复杂度是正确的！因为每次连边的两个点都是在不同的连通块中，做完这次操作以后它们就会被合并，因此如果我们遍历一遍较小的连通块，总时间复杂度是 <span class="arithmatex">\(O(n\log n)\)</span>！因此，这道 G 题出乎意料地短，甚至比我的随机化代码还要少。</p>
<hr />
<p>写在最后：这次 ABC 可以看到除了少部分人，大多数人都没有取得很理想，甚至可以说糟糕的成绩。比赛结束后，我听到有人在机房里咒骂自己、题目和出题人的。还有人为了 <code>rating</code> 而闷闷不乐，诸如此类。但是有一点他们都错了，我们打比赛不是为了 <code>rating</code> 去打，不是为了成绩去打。以我为例，这次比赛我的 <code>delta</code> 是 <code>-6</code>，相对于之前 <code>2200+</code> 的 <code>performance</code>，可谓是相当的差。但是，在这背后，是我被打乱的做题节奏，被扰乱的心态，是我过于激动的心情。这次比赛，暴露了我很多问题：代码实现不准不细心，读题不仔细，对时间复杂度的不敏感，对时间复杂度证明的不熟练，而这些，都为我提供了宝贵的经验，这远远不是几点 <code>rating</code> 所能给我的。之前还看到旁边的人比赛时一起讨论题目，其实也是十分不应该——如果人人都只在乎 <code>rating</code> 以至于无人在乎算法背后的玄妙，在乎它们的出处与归宿，那么 <code>rating</code> 早已失去它本来的意义了。希望各位在天涯海角的 <code>OIer</code> 都能保住自己的初心，守住心中的一寸净土，为了 <code>OI</code>，<code>ACM</code>，乃至 <code>CS</code> 的明天而砥砺前行。</p>
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <a class="md-pagination__link" href="../../">1</a> <a class="md-pagination__link" href="../2/">2</a> <span class="md-pagination__current">3</span>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
          <div class="md-copyright__highlight">
            Copyright © 2024 Liam<br>© 本页面的全部内容在 <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> 和 <a href="https://github.com/zTrix/sata-license">SATA</a> 协议之条款下提供，附加条款亦可能应用
          </div>
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        & 
        <a href="https://github.com/features/actions" target="_blank" rel="noopener">
          GitHub Actions
        </a>
      </div>
      <div class="md-social">
        <a href="https://github.com/lnw143" target="_blank" rel="noopener" title="github" class="md-social__link">
          <img src="https://github.com/fluidicon.png" alt="github">
        </a>
        <a href="https://www.luogu.com.cn/user/767819" target="_blank" rel="noopener" title="luogu" class="md-social__link">
          <img src="https://www.luogu.com.cn/favicon.ico" alt="luogu">
        </a>
        <a href="https://codeforces.com/profile/lnw143" target="_blank" rel="noopener" title="codeforces" class="md-social__link">
          <img src="https://codeforces.org/s/96336/favicon-32x32.png" alt="codeforces">
        </a>
        <a href="https://atcoder.jp/users/lnw143" target="_blank" rel="noopener" title="atcoder" class="md-social__link">
          <img src="https://img.atcoder.jp/assets/logo.png" alt="atcoder">
        </a>
        <a href="https://www.topcoder.com/members/lnw143/" target="_blank" rel="noopener" title="topcoder" class="md-social__link">
          <img src="https://www.topcoder.com/favicon.ico" alt="topcoder">
        </a>
      </div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.annotate", "content.code.select", "content.action.view", "content.code.copy", "navigation.tabs", "navigation.instant", "navigation.indexes"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
	<!-- Add scripts that need to run before here -->
	
      <script src="../../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
        <script src="https://unpkg.com/jquery@3.4.1/dist/jquery.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script>
      
    
	<!-- Add scripts that need to run afterwards here -->
	<!-- music module -->
	<meting-js
		server="netease"
		type="playlist"
		id="12370214543"
		fixed="true"
		loop="all"
		volume="0.3"
	>
	</meting-js>

  </body>
</html>